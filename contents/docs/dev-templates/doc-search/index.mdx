---
title: Next.js OpenAI Doc Search Starter
description: Plantilla para crear su propia b煤squeda de documentos personalizada en estilo ChatGPT impulsada por Next.js, OpenAI y Supabase.
keywords: [ "nextjs", "app", "ia"]
---

![Banner](https://vercel.com/_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2Fe5382hct74si%2F1OntM6THNEUvlUsYy6Bjmf%2F475e39dbc84779538c8ed47c63a37e0e%2Fnextjs_openai_doc_search_og.png&w=1920&q=75)


## LINKS

<CardGrid>
  <Card
    title="Template"
    href="https://vercel.com/templates/next.js/nextjs-openai-doc-search-starter"
    icon="alignJustify"
    variant="small"
    external={true}
  />
  <Card
    title="Demo"
    href="#"
    icon="alignJustify"
    variant="small"
    external={true}
  />
  <Card
    title="Respositorio GitHub"
    href="https://github.com/supabase-community/nextjs-openai-doc-search"
    icon="alignJustify"
    variant="small"
    external={true}
  />
  
</CardGrid>
---

## DESCRIPCION GENERAL 

Este iniciador toma todos los archivos `.mdx` en el directorio `pages` y los procesa para usarlos como contexto personalizado dentro de las indicaciones de [Finalizaci贸n de texto de OpenAI](https://platform.openai.com/docs/guides/completion).

### STACK TECNOLOGICO

* **Framework**: Next.js
* **Caso de uso**: AI
* **CSS**: Tailwind
* **Database**: Supabase

### LICENCIA

Apache 2.0

### CARACTERISTICAS

## Despliegue

Despliega este iniciador en Vercel. La integraci贸n de Supabase establecer谩 autom谩ticamente las variables de entorno requeridas y configurar谩 tu [Esquema de base de datos](./supabase/migrations/20230406025118_init.sql). 隆Todo lo que tienes que hacer es configurar tu `OPENAI_KEY` y estar谩s listo!

## Detalles T茅cnicos

Construir tu propio ChatGPT personalizado implica cuatro pasos:

1. [ Tiempo de compilaci贸n] Pre-procesar la base de conocimiento (tus archivos `.mdx` en tu carpeta `pages`).
2. [ Tiempo de compilaci贸n] Almacenar los embeddings  en Postgres con [pgvector](https://supabase.com/docs/guides/database/extensions/pgvector).
3. [ Tiempo de ejecuci贸n] Realizar una b煤squeda de similitud vectorial para encontrar el contenido que sea relevante para la pregunta.
4. [ Tiempo de ejecuci贸n] Inyectar contenido en la indicaci贸n de finalizaci贸n de texto de OpenAI GPT-3 y transmitir la respuesta al cliente.

##  Tiempo de Compilaci贸n

Los pasos 1 y 2 ocurren en tiempo de compilaci贸n, por ejemplo, cuando Vercel construye tu aplicaci贸n Next.js. Durante este tiempo, se est谩 ejecutando el script [`generate-embeddings`](./lib/generate-embeddings.ts), que realiza las siguientes tareas:

<Mermaid
  chart={`
    sequenceDiagram
    participant Vercel
    participant DB (pgvector)
    participant OpenAI (API)
    loop 1. Pre-procesar la base de conocimiento
        Vercel->>Vercel: Dividir las p谩ginas .mdx en secciones
        loop 2. Crear y almacenar incrustaciones
            Vercel->>OpenAI (API): crear incrustaci贸n para la secci贸n de la p谩gina
            OpenAI (API)->>Vercel: vector de incrustaci贸n(1536)
            Vercel->>DB (pgvector): almacenar la incrustaci贸n para la secci贸n de la p谩gina
        end
    end
  `}
/>


```mermaid
sequenceDiagram
    participant Vercel
    participant DB (pgvector)
    participant OpenAI (API)
    loop 1. Pre-procesar la base de conocimiento
        Vercel->>Vercel: Dividir las p谩ginas .mdx en secciones
        loop 2. Crear y almacenar incrustaciones
            Vercel->>OpenAI (API): crear incrustaci贸n para la secci贸n de la p谩gina
            OpenAI (API)->>Vercel: vector de incrustaci贸n(1536)
            Vercel->>DB (pgvector): almacenar la incrustaci贸n para la secci贸n de la p谩gina
        end
    end
```

Adem谩s de almacenar las incrustaciones, este script genera una suma de comprobaci贸n para cada uno de tus archivos `.mdx` y la almacena en otra tabla de la base de datos para asegurarse de que las incrustaciones solo se regeneren cuando el archivo haya cambiado.

##  Tiempo de Ejecuci贸n

Los pasos 3 y 4 ocurren en tiempo de ejecuci贸n, cada vez que el usuario env铆a una pregunta. Cuando esto sucede, se realiza la siguiente secuencia de tareas:

<Mermaid
  chart={`
    sequenceDiagram
    participant Cliente
    participant Funci贸n Edge
    participant DB (pgvector)
    participant OpenAI (API)
    Cliente->>Funci贸n Edge: { query: lorem ispum }
    critical 3. Realizar b煤squeda de similitud vectorial
        Funci贸n Edge->>OpenAI (API): crear incrustaci贸n para la consulta
        OpenAI (API)->>Funci贸n Edge: vector de incrustaci贸n(1536)
        Funci贸n Edge->>DB (pgvector): b煤squeda de similitud vectorial
        DB (pgvector)->>Funci贸n Edge: contenido de documentos relevantes
    end
    critical 4. Inyectar contenido en la indicaci贸n
        Funci贸n Edge->>OpenAI (API): solicitud de finalizaci贸n prompt: consulta + contenido de documentos relevantes
        OpenAI (API)-->>Cliente: text/event-stream: respuesta de finalizaciones
    end
  `}
/>

```mermaid
sequenceDiagram
    participant Cliente
    participant Funci贸n Edge
    participant DB (pgvector)
    participant OpenAI (API)
    Cliente->>Funci贸n Edge: { query: lorem ispum }
    critical 3. Realizar b煤squeda de similitud vectorial
        Funci贸n Edge->>OpenAI (API): crear incrustaci贸n para la consulta
        OpenAI (API)->>Funci贸n Edge: vector de incrustaci贸n(1536)
        Funci贸n Edge->>DB (pgvector): b煤squeda de similitud vectorial
        DB (pgvector)->>Funci贸n Edge: contenido de documentos relevantes
    end
    critical 4. Inyectar contenido en la indicaci贸n
        Funci贸n Edge->>OpenAI (API): solicitud de finalizaci贸n prompt: consulta + contenido de documentos relevantes
        OpenAI (API)-->>Cliente: text/event-stream: respuesta de finalizaciones
    end
```

Los archivos relevantes para esto son el componente [`SearchDialog` (Cliente)](./components/SearchDialog.tsx) y la [`vector-search` (Funci贸n Edge)](./pages/api/vector-search.ts).

La inicializaci贸n de la base de datos, incluida la configuraci贸n de la extensi贸n `pgvector`, se almacena en la [`carpeta supabase/migrations`](./supabase/migrations/), que se aplica autom谩ticamente a tu instancia local de Postgres cuando se ejecuta `supabase start`.

## Desarrollo Local

### Configuraci贸n

- `cp .env.example .env`
- Configura tu `OPENAI_KEY` en el archivo `.env` reci茅n creado.
- Configura `NEXT_PUBLIC_SUPABASE_ANON_KEY` y `SUPABASE_SERVICE_ROLE_KEY` ejecutando:
  > Nota: Tienes que ejecutar supabase para recuperar las claves.


### CONTACTO 
---
## CLONAR REPOSITORIO 

<Step>
  <StepItem title="Clonar repositorio">
   
    Contenido 1

  </StepItem>

  <StepItem title="Conectar con nuevo repositorio de GitHub">
    
    Contenido 2

  </StepItem>

  <StepItem title="Instalar dependencias">
    
    Contenido 3

  </StepItem>
</Step>
